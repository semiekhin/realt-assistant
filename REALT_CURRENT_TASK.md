# Realt Assistant ‚Äî –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏

## üéØ –ì–ª–∞–≤–Ω–∞—è –∑–∞–¥–∞—á–∞: RAG-—è–¥—Ä–æ

**–°—Ç–∞—Ç—É—Å:** –≠—Ç–∞–ø—ã 1-3 –∑–∞–≤–µ—Ä—à–µ–Ω—ã  
**–¢–ó:** docs/RAG_CORE_SPEC.md

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ë–æ—Ç = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π Claude –¥–ª—è —Ä–∏—ç–ª—Ç–æ—Ä–∞. –ù–∏–∫–∞–∫–∏—Ö –∂—ë—Å—Ç–∫–∏—Ö –º–µ–Ω—é –∏ —à–∞–±–ª–æ–Ω–æ–≤. –ó–∞–≥—Ä—É–∑–∏–ª –¥–æ–∫—É–º–µ–Ω—Ç—ã ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–π —á—Ç–æ —É–≥–æ–¥–Ω–æ ‚Äî –ø–æ–ª—É—á–∞–π —É–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.

### –≠—Ç–∞–ø—ã

- [x] **–≠—Ç–∞–ø 1: RAG —è–¥—Ä–æ** ‚Äî ChromaDB, chunking, embeddings, –ø–æ–∏—Å–∫ ‚úÖ
- [x] **–≠—Ç–∞–ø 2: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π handler** ‚Äî —É–±–∏—Ä–∞–µ–º FSM, –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí RAG ‚Üí LLM ‚úÖ
- [x] **–≠—Ç–∞–ø 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** ‚Äî LLM ‚Üí HTML ‚Üí PDF (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ) ‚úÖ
- [ ] **–≠—Ç–∞–ø 4: –î–µ–π—Å—Ç–≤–∏—è** ‚Äî –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ LLM (—á–∞—Å—Ç–∏—á–Ω–æ)
- [ ] **–≠—Ç–∞–ø 5: –ü–æ–º–æ—â–Ω–∏–∫ –ø–µ—Ä–µ–ø–∏—Å–∫–∏** ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

---

## üìÖ –°–µ—Å—Å–∏—è 08.01.2026 (–≤–µ—á–µ—Ä) ‚Äî –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π handler + HTML‚ÜíPDF

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

**–≠—Ç–∞–ø 2: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π handler (v0.5.0)**
* **–¢–∞–±–ª–∏—Ü–∞ chat_history** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ –≤ SQLite
* **–§—É–Ω–∫—Ü–∏–∏ –ë–î:** save_message(), get_chat_history(), clear_chat_history()
* **UNIVERSAL_PROMPT** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª—é–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π –¥–µ–π—Å—Ç–≤–∏–π
* **universal_respond()** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏
* **parse_llm_response()** ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç JSON –¥–µ–π—Å—Ç–≤–∏—è –∏–ª–∏ —Ç–µ–∫—Å—Ç
* **handle_universal()** ‚Äî –∑–∞–º–µ–Ω–∏–ª FSM –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫—Ä–æ–º–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
* **execute_action()** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è (–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã, –ö–ü)

**–≠—Ç–∞–ø 3: LLM ‚Üí HTML ‚Üí PDF (v0.5.1)**
* **services/html_to_pdf.py** ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä —á–µ—Ä–µ–∑ wkhtmltopdf
* **GENERATE_HTML_PROMPT** ‚Äî LLM —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–¥–∞—é—â–∏–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
* **generate_html_document()** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ñ–ö
* **generate_kp_universal()** ‚Äî –∞–≤—Ç–æ–≤—ã–±–æ—Ä –ñ–ö –ø–æ –∏–º–µ–Ω–∏ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
* **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, —Ç–µ–Ω–∏, —Ç–∞–±–ª–∏—Ü—ã —Ü–µ–Ω

**–£–ª—É—á—à–µ–Ω–∏—è RAG –ø–æ–∏—Å–∫–∞**
* **enrich_query_for_rag()** ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä
* **extract_price_range()** ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
* **limit=50** ‚Äî —É–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç —á–∞–Ω–∫–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
* **gpt-4o** ‚Äî —Å–º–µ–Ω–∏–ª–∏ –º–æ–¥–µ–ª—å –¥–ª—è —Ç–æ—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —á–∏—Å–ª–∞–º–∏
* **–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç** ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –í–°–ï–• –∫–≤–∞—Ä—Ç–∏—Ä –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ

### üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –∫–∞–∫–∏–µ –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç 15 –¥–æ 19 –º–ª–Ω
–ë–æ—Ç: [–Ω–∞—Ö–æ–¥–∏—Ç –í–°–ï 5 –∫–≤–∞—Ä—Ç–∏—Ä –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ]
1. –ñ–ö –ü—Ä–æ—Å–ø–µ–∫—Ç 82 ‚Ññ260 | 46.49 –º¬≤ | 15.11 –º–ª–Ω ‚ÇΩ | 4 —ç—Ç.
2. –ñ–ö –ú–æ–π–Ω–∞–∫–æ ‚Ññ303 | 42.12 –º¬≤ | 16.18 –º–ª–Ω ‚ÇΩ | 18 —ç—Ç.
3. –ñ–ö –ú–æ–π–Ω–∞–∫–æ ‚Ññ112 | 39.85 –º¬≤ | 16.53 –º–ª–Ω ‚ÇΩ | 8 —ç—Ç.
4. –ñ–ö –ü—Ä–æ—Å–ø–µ–∫—Ç 82 ‚Ññ322 | 56.52 –º¬≤ | 16.67 –º–ª–Ω ‚ÇΩ | 9 —ç—Ç.
5. –ñ–ö –ú–æ–π–Ω–∞–∫–æ ‚Ññ618 | 40.13 –º¬≤ | 18.37 –º–ª–Ω ‚ÇΩ | 15 —ç—Ç.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: —Å–¥–µ–ª–∞–π –∫–ø –Ω–∞ –±–µ–ª—ã–µ –Ω–æ—á–∏
–ë–æ—Ç: [–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π PDF —Å —Ü–µ–Ω–∞–º–∏, –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ø–æ—Å—á–∏—Ç–∞–π —Ä–∞—Å—Å—Ä–æ—á–∫—É: —Ü–µ–Ω–∞ 21 –º–ª–Ω, –ø–≤ 50%, —Å—Ä–æ–∫ 12 –º–µ—Å—è—Ü–µ–≤
–ë–æ—Ç: [–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏]
```

### üü¢ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

* **–í–µ—Ä—Å–∏—è:** v0.5.1
* **–ú–æ–¥–µ–ª—å:** gpt-4o (–±—ã–ª–∞ gpt-4o-mini)
* **–ë–æ—Ç:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π handler —Ä–∞–±–æ—Ç–∞–µ—Ç
* **–ö–ü:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ LLM ‚Üí HTML ‚Üí PDF
* **RAG:** limit=50, —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ü–µ–Ω–∞–º

### üîú –°–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏

1. **–≠—Ç–∞–ø 4: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ LLM** ‚Äî –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. **–≠—Ç–∞–ø 5: –ü–æ–º–æ—â–Ω–∏–∫ –ø–µ—Ä–µ–ø–∏—Å–∫–∏** ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤

### üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| db/database.py | +chat_history —Ç–∞–±–ª–∏—Ü–∞, save_message, get_chat_history |
| services/llm.py | +UNIVERSAL_PROMPT, universal_respond, parse_llm_response, GENERATE_HTML_PROMPT, generate_html_document |
| services/html_to_pdf.py | **NEW** ‚Äî HTML ‚Üí PDF —á–µ—Ä–µ–∑ wkhtmltopdf |
| app.py | +handle_universal, execute_action, generate_kp_universal, enrich_query_for_rag, extract_price_range |
| .env | OPENAI_MODEL=gpt-4o |

---

## üìÖ –°–µ—Å—Å–∏—è 08.01.2026 (–Ω–æ—á—å) ‚Äî RAG-—è–¥—Ä–æ –≥–æ—Ç–æ–≤–æ

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

* **ChromaDB —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
* **services/rag.py** ‚Äî –ø–æ–ª–Ω—ã–π RAG engine:
  - `chunk_text()` ‚Äî —Ä–∞–∑–±–∏–≤–∫–∞ –Ω–∞ —á–∞–Ω–∫–∏ 800 —Å–∏–º–≤–æ–ª–æ–≤ —Å overlap 100
  - `get_embedding()` ‚Äî OpenAI text-embedding-3-small
  - `add_document()` ‚Äî –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - `search()` ‚Äî —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∑–∞–ø—Ä–æ—Å—É
  - `delete_property_chunks()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ñ–ö
* **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ add_property.py** ‚Äî –∞–≤—Ç–æ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤
* **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ query.py** ‚Äî –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ RAG —Å fallback
* **–†–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** ‚Äî 33 —Ñ–∞–π–ª–∞ ‚Üí ~170 —á–∞–Ω–∫–æ–≤ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã

### üìÅ –ù–æ–≤—ã–µ/–∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| services/rag.py | **NEW** ‚Äî RAG engine (ChromaDB + embeddings) |
| bot/handlers/add_property.py | +–∏–º–ø–æ—Ä—Ç rag, +–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ñ–ö |
| bot/handlers/query.py | +–∏–º–ø–æ—Ä—Ç rag, –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ RAG |
| data/chroma/ | **NEW** ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ChromaDB |

---

## üìÖ –°–µ—Å—Å–∏—è 08.01.2026 (–¥–µ–Ω—å) ‚Äî –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ RAG-—è–¥—Ä–∞

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

* **–ê—É–¥–∏—Ç –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã** ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ GitHub
* **–í–µ—Ä—Å–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞** ‚Äî app.py –æ–±–Ω–æ–≤–ª—ë–Ω –¥–æ v0.4.0 ‚Üí v0.4.1
* **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –ñ–ö** ‚Äî –∫–Ω–æ–ø–∫–∞ "üßÆ –†–∞—Å—á—ë—Ç" –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –æ–±—ä–µ–∫—Ç–∞
* **–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –¢–ó –Ω–∞ RAG-—è–¥—Ä–æ** ‚Äî docs/RAG_CORE_SPEC.md

---

## üìÖ –°–µ—Å—Å–∏—è 07.01.2026 (–≤–µ—á–µ—Ä) ‚Äî Vision-first –ø–∞—Ä—Å–µ—Ä

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

* **Vision-first –ø–∞—Ä—Å–µ—Ä (v0.4.0)** ‚Äî PDF ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí GPT-4o
* **–ó–∞–ø—Ä–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π** ‚Äî –∫–æ–º–∏—Å—Å–∏—è null –≤–º–µ—Å—Ç–æ –≤—ã–¥—É–º–∞–Ω–Ω—ã—Ö 3%
* **–ù–æ–≤—ã–µ –ø–æ–ª—è:** distance_to_sea, territory_area, hotel_operator

---

## üìÖ –°–µ—Å—Å–∏—è 07.01.2026 (–¥–µ–Ω—å) ‚Äî v0.3.0

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

* **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã:** —Ä–∞—Å—Å—Ä–æ—á–∫–∞, –∏–ø–æ—Ç–µ–∫–∞ (4 –ø—Ä–æ–≥—Ä–∞–º–º—ã), ROI
* **Content Composer** ‚Äî LLM —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–¥–∞—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
* **6 —Å—Ç–∏–ª–µ–π PDF** ‚Äî premium, business, corporate, modern, minimal, warm
* **GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** ‚Äî https://github.com/semiekhin/realt-assistant
